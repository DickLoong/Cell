# Cell
一个实验项目，探讨为什么当前微服务实践中服务划分成本、调试成本和部署成本会是最大的成本痛点，为什么服务粒度大小自动伸缩能在不引入新成本的前提下降低这些成本，并尝试通过实现一个代码生成套件和服务调用插件，实现一个服务粒度大小的自动化伸缩的微服务架构demo。
## 前言
为什么当前微服务实践中服务划分成本、调试成本和部署成本会是最大的成本痛点？那是因为对比一体化架构，微服务架构增加了这些需求，以换取不同系统间耦合度的下降，从而实现更高的可用性，但是目前流行的微服务实践是通过人肉劳动来满足这些需求，而人是实现计算机系统时最贵且最不可靠的资源，于是导致这种交换强依赖于人，从而导致微服务架构开发成本比一体化架构高非常多，而这种成本却不一定是必要的，属于一种痛点，下面将举例说明。
### 场景
本人于2015-2016年曾任职于国内一家5000员工量级、注册用户接近一亿量级的电话推销线下场所服务的公司。该企业通过内部CRM系统支持日均10W次用户联络和5%转化率的支付流程，同时维护数十个各种数据相互交联的实时报表（2016年数据）。2009-2017年间，该系统是一个一体化架构的系统，业务数据表都在同一个库内，维护该系统的程序员主要是通过sql实现各种功能，不能通过sql实现的需求或者sql很难实现的需求，比如跨机器跨库查询报表或者复杂逻辑报表，则是另外写业务代码来实现，简而言之，业务沉降在数据库层面。产品经理提的需求也很灵活，除了功能需求，新增的报表需求也很多，而且逻辑常常穿透很多层面，比如电话沟通数据关联支付数据关联投诉数据，等等。随着业务发展，该系统分别实现了读写分离和对若该热点表的分表处理以满足需要。而在2015年前，此系统核心业务也基本保持了99.99%的可靠性。但是，该企业2015-2016年业务量增长了60%以上，新增的业务复杂度和数据量压力该系统2015年-2016年的可靠性下降到了99.7%，具体表现为原来需求稳定的业务被新增功能影响至失灵，基于原有基础开发功能也因为数据表文档的缺失难以开展开发工作。此时支持该系统的数据库实例数也已达到了34台，表数量达到了3000个以上（sharding过的表和无sharding的表合在了一起），这么多的机器和表，可靠性却下降了，意味着问题不在性能上。
### 已有的解决方案
在2017-2018期间，该系统经过以下两个改造，可靠性再一次回到了99.99%，分别是引入了自动化测试，以及微服务架构改造，其中微服务架构改造具体过程如下：
1.将原来的一体化应用按照业务组织划分拆成多个小的应用
2.按照应用划分数据库，不同应用之间数据库不能直接sql调用，跨应用数据调用通过接口获取
3.引入storm和kafka，各个应用推送实时数据到storm，通过storm实现实时报表
4.建立应用运维团队，负责各个应用的自动化运维，包括构建、部署、发布等，通过jenkins和docker实现一键集成
### 分析.问题是怎样解决的.将会有什么问题
